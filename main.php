<?php
/*
 * main.php - ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ñ„Ğ°Ğ¹Ğ», ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ Ñ‚ĞµĞºÑƒÑ‰ÑƒÑ Ğ¸Ğ³Ñ€Ñƒ.
 * classes.php - Ğ¤Ğ°Ğ¹Ğ» Ñ ĞºĞ»Ğ°ÑÑĞ°Ğ¼Ğ¸.
 * function.php - Ğ¤Ğ°Ğ¹Ğ» Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸ÑĞ¼Ğ¸.
 *
 * Ğ§ĞµĞ»Ğ¾Ğ²ĞµĞº Ğ²ÑĞµĞ³Ğ´Ğ° Ğ¸Ğ³Ñ€Ğ°ĞµÑ‚ Ğ·Ğ° "Ğ", Ğ±Ğ¾Ñ‚ Ğ²ÑĞµĞ³Ğ´Ğ° Ğ·Ğ° "X".
 * ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ñ…Ğ¾Ğ´Ğ¾Ğ² Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ÑÑ Ğ² ĞºĞ»Ğ°ÑÑĞµ Ğ¸Ğ³Ñ€Ñ‹.
 * */
require "classes.php";

$stdin = fopen("php://stdin", "r");
$game = new game();

//ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ¸Ğ³Ñ€Ğ°, Ğ¿Ğ¾ĞºĞ° Ğ½Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµÑ‚ÑÑ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğµ Ğ¿Ğ¾Ğ±ĞµĞ´Ñ‹
while(!$game->endGame()){

    if($game->curr_player == $game->human)
        $game->turn($game->curr_player);
    else {
        if($game->field->data[4] != 4) {                                    //ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ…Ğ¾Ğ´ ÑÑ‚Ğ¾ ÑĞ°Ğ¼Ñ‹Ğ¹ Ñ†ĞµĞ½Ñ‚Ñ€ Ğ¿Ğ¾Ğ»Ñ, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ½Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°Ñ‚ÑŒ Ñ€ĞµĞºÑƒÑ€ÑĞ¸Ñ, ĞµÑĞ»Ğ¸ ÑÑ‚Ğ¾ Ğ¿Ğ¾Ğ»Ğµ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾.
            $index = $game->miniMax($game->field->data, $game->ai);         //Ğ˜Ğ½Ğ°Ñ‡Ğµ ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°ĞºÑ'Ğ¾Ğ¼ Ğ¸Ñ‰ĞµĞ¼ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ…Ğ¾Ğ´.
            $game->field->put($game->ai, $index->index);                    //Ğ˜ ÑÑ‚Ğ°Ğ²Ğ¸Ğ¼ "X" Ğ² ÑÑ‚Ñƒ ÑÑ‡ĞµĞ¹ĞºÑƒ.
        }else{                                                              //
            $game->field->put($game->ai, 4);
        }
    }

    if(count($game->countFree($game->field->data)) == 0) {                  //Ğ•ÑĞ»Ğ¸ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ñ‹Ñ… ÑÑ‡ĞµĞµĞº Ğ½ĞµÑ‚ - Ğ½Ğ¸Ñ‡ÑŒÑ.
        print("[5;31mDRAW[0m\n");
        $game->field->draw();
        exit;
    }
    $game->swapTurn();                                                      //Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¸ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğ¹ Ğ¸Ğ³Ñ€Ğ¾Ğº Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ

}


print("\n".$game->winner);
$game->field->draw();
